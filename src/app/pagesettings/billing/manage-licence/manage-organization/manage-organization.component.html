<div>
  <nav aria-label="breadcrumb" style="margin-left: -14px">
    <ol class="breadcrumb breadcrumb-style1 mg-b-10">
      <li class="breadcrumb-item">Billing</li>
      <li class="breadcrumb-item"><a routerLink="/settings/billing/manage">Manage Licenses</a></li>
      <li class="breadcrumb-item active">Organizations</li>

    </ol>
  </nav>
  <h4 class="mg-b-0 tx-spacing--1">Manage Organizations</h4>

</div>
<div class="card mt-4">
  <div class="row">
    <h5 class=" col-md-12 mt-4 plan-name cl-gray" style="font-weight: bold;">{{productName + ' - ' +planName}}</h5>
    <div class=" col-md-12">
      <h4 class="assign-text cl-gray">{{assigneLicence}}/{{totalLicence}} Assigned</h4>
      <div class="col-md-4">
        <div class="progress" style="height:16px">
          <div class="progress-bar" [ngStyle]="{width: percents.assigneLicence +'%'}" style=" background-color: #11188f">
          </div>
          <div class="progress-bar"  [ngStyle]="{width: percents.totalLicence +'%'}" style="background-color: #3d78d4">
          </div>
        </div>
      </div>

      <div class="row pl-3 mt-3">
        <div class="col-md-5">
          <div class="row">
          <div class="col-md-3 cl-gray type-text">
            <i class="fa fa-square" style="color:#11188f" aria-hidden="true"></i>
            Assigned
          </div>
          <div class="col-md-3 cl-gray type-text pl-0">
            <i class="fa fa-square" style="color:#3d78d4" aria-hidden="true"></i>
            Available
          </div>
        </div>
        </div>
      </div>
    </div>

    <div class="col-md-12 mt-4">
      <div class="btn-group">
        <button type="button" (click)="openModal(template)" class="btn cl-gray btn-default action-btn">
          <i class="fa icon-text pr-2 fa-plus" aria-hidden="true"></i>
           Assign New Organization</button>
        <button type="button" (click)="onGetAssingedOrg()" class="btn cl-gray btn-default action-btn">
          <i class="fa icon-text fa-retweet pr-2" aria-hidden="true"></i>
          Refresh</button>
      </div>
    </div>
  </div>


  <div class="card-body">
    <ng-container *ngIf="!skLoading">
    <table class="table" >
      <thead>
      <tr>
        <th>Organization Name</th>
        <th></th>
        <th>Email</th>
        <th>Organization</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let obj of orgList">
        <td>{{obj.orgname}}</td>
        <td>



          <div class="btn-group" dropdown>
            <button  id="button-basic" dropdownToggle type="button" class="btn btn-default"
                    aria-controls="dropdown-basic">
                    <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
            </button>
            <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu"
                role="menu" aria-labelledby="button-basic">
              <li role="menuitem"><a class="dropdown-item"  (click)="onRemoveOrg(obj.id)" href="javascript:void(0)">Remove</a></li>

            </ul>
          </div>

        </td>
        <td>{{obj.email }}</td>
        <td> {{obj.city+ ', ' + obj.state + ', ' + obj.zipcode}} </td>
        <td><i class="fa fa-check" aria-hidden="true"></i>
        </td>

      </tr>

      </tbody>
    </table>
    <ng-container *ngIf="orgList.length == 0">
      <div class="alert cs-alert w-100 alert-info">There is no organization assign to this plan</div>
      </ng-container>
      </ng-container>
    <ngx-skeleton-loader  *ngIf="skLoading" count="6" class="pt-4"></ngx-skeleton-loader>



  </div>
</div>



<ng-template #template>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Assign New Organization</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="orgForm" (ngSubmit)="onSubmit()">
      <label for="typeahead-basic">Find Property:</label>
      <p-multiSelect class="gdprSelect"  [disabled]="totalLicence - assigneLicence === 0"  [selectionLimit]="totalLicence - assigneLicence"
      formControlName="orgID" [style]="{'width':'100%'}" [options]="allUnSignOrgList" ></p-multiSelect>
      <p *ngIf="orgNameError">This Field is Required</p>

    <div class="mt-4 text-center">
      <button type="button" class="btn btn-primary" aria-label="Close" (click)="modalRef.hide()">Cancel</button>
      <button type="submit" class="btn ml-3 btn-primary">Assign</button>
    </div>
    </form>
  </div>
</ng-template>


<div class="col-sm-5 mr-0 float-right flotingdiv" [ngClass]="{'hide':!isOpen}">
  <alert *ngIf="isOpen" [type]="alertType" dismissOnTimeout="5000" >{{  alertMsg}}</alert>
</div>
